library(ISR3)
x1 <- c(rep(1300,6),rep(1200,6), rep(1100,4))
x2 <- c(7.5, 9.0, 11.0, 13.5, 17.0,
        23.0, 5.3, 7.5, 11.0, 13.5,
        17.0, 23.0, 5.3, 7.5, 11.0,
        17.0)
x3 <- c(0.012, 0.012, 0.0115, 0.013, 0.0135,
        0.012, 0.040, 0.038, 0.032, 0.026,
        0.034, 0.041, 0.084, 0.098, 0.092,
        0.086)
y <- c(49.0, 50.2, 50.5, 48.5, 47.5,
       44.5, 28.0, 31.5, 34.5, 35.0,
       38.0, 38.5, 15.0, 17.0, 20.5,
       29.5)
cbind(X,X)
x4 <- x1 * x1
x5 <- x2 * x2
x6 <- x3 * x3
x7 <- x1 * x2
x8 <- x1 * x3
x9 <- x2 * x3

X <- matrix(c(rep(1,16), x1, x2, x3, x4, x5, x6, x7, x8, x9), ncol = 10)

#Cholesky
A <- t(X) %*% X
L <- t(chol(A))
B <- solve(t(L), solve(L, t(X) %*% y)) #theta == solve(L, t(X) %*% y)
B

#SWEEP
M <- matrix(rbind(cbind(A, t(X) %*% y), cbind(t(y) %*% X, t(y) %*% y)), nrow = 11)
M2 <- SWP(M, 1:10)
M2
#M2[1:10,1:10] = -Solve(A) 
#M2[11,11] variance estimate
#M2[1:10,11] = B
XX <- -M2[1:10,1:10]
sqrt(diag(XX * (M2[11,11]/12))) #sd???

g <- lm(y~x1+x2+x3+x4+x5+x6+x7+x8+x9)
summary(g)
